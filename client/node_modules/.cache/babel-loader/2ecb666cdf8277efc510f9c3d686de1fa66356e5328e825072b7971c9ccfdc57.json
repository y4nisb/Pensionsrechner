{"ast":null,"code":"\"use strict\";\n\nconst {\n  HTML_NS\n} = require(\"./namespaces\");\nconst {\n  createElement,\n  getValidTagNames\n} = require(\"./create-element\");\nconst {\n  implForWrapper,\n  wrapperForImpl\n} = require(\"../generated/utils\");\n\n// https://html.spec.whatwg.org/multipage/custom-elements.html#concept-already-constructed-marker\nconst ALREADY_CONSTRUCTED_MARKER = Symbol(\"already-constructed-marker\");\n\n// https://html.spec.whatwg.org/multipage/dom.html#htmlconstructor\nfunction HTMLConstructor(globalObject, constructorName, newTarget) {\n  const registry = implForWrapper(globalObject.customElements);\n  if (newTarget === HTMLConstructor) {\n    throw new TypeError(\"Invalid constructor\");\n  }\n  const definition = registry._customElementDefinitions.find(entry => entry.objectReference === newTarget);\n  if (definition === undefined) {\n    throw new TypeError(\"Invalid constructor, the constructor is not part of the custom element registry\");\n  }\n  let isValue = null;\n  if (definition.localName === definition.name) {\n    if (constructorName !== \"HTMLElement\") {\n      throw new TypeError(\"Invalid constructor, autonomous custom element should extend from HTMLElement\");\n    }\n  } else {\n    const validLocalNames = getValidTagNames(HTML_NS, constructorName);\n    if (!validLocalNames.includes(definition.localName)) {\n      throw new TypeError(`${definition.localName} is not valid local name for ${constructorName}`);\n    }\n    isValue = definition.name;\n  }\n  let {\n    prototype\n  } = newTarget;\n  if (prototype === null || typeof prototype !== \"object\") {\n    // The following line deviates from the specification. The HTMLElement prototype should be retrieved from the realm\n    // associated with the \"new.target\". Because it is impossible to get such information in jsdom, we fallback to the\n    // HTMLElement prototype associated with the current object.\n    prototype = globalObject.HTMLElement.prototype;\n  }\n  if (definition.constructionStack.length === 0) {\n    const documentImpl = implForWrapper(globalObject.document);\n    const elementImpl = createElement(documentImpl, definition.localName, HTML_NS);\n    const element = wrapperForImpl(elementImpl);\n    Object.setPrototypeOf(element, prototype);\n    elementImpl._ceState = \"custom\";\n    elementImpl._ceDefinition = definition;\n    elementImpl._isValue = isValue;\n    return element;\n  }\n  const elementImpl = definition.constructionStack[definition.constructionStack.length - 1];\n  const element = wrapperForImpl(elementImpl);\n  if (elementImpl === ALREADY_CONSTRUCTED_MARKER) {\n    throw new TypeError(\"This instance is already constructed\");\n  }\n  Object.setPrototypeOf(element, prototype);\n  definition.constructionStack[definition.constructionStack.length - 1] = ALREADY_CONSTRUCTED_MARKER;\n  return element;\n}\nmodule.exports = {\n  HTMLConstructor\n};","map":{"version":3,"names":["HTML_NS","require","createElement","getValidTagNames","implForWrapper","wrapperForImpl","ALREADY_CONSTRUCTED_MARKER","Symbol","HTMLConstructor","globalObject","constructorName","newTarget","registry","customElements","TypeError","definition","_customElementDefinitions","find","entry","objectReference","undefined","isValue","localName","name","validLocalNames","includes","prototype","HTMLElement","constructionStack","length","documentImpl","document","elementImpl","element","Object","setPrototypeOf","_ceState","_ceDefinition","_isValue","module","exports"],"sources":["C:/Users/noodp/Documents/GitHub/Pensionsrechner/client/node_modules/jsdom/lib/jsdom/living/helpers/html-constructor.js"],"sourcesContent":["\"use strict\";\r\n\r\nconst { HTML_NS } = require(\"./namespaces\");\r\nconst { createElement, getValidTagNames } = require(\"./create-element\");\r\n\r\nconst { implForWrapper, wrapperForImpl } = require(\"../generated/utils\");\r\n\r\n// https://html.spec.whatwg.org/multipage/custom-elements.html#concept-already-constructed-marker\r\nconst ALREADY_CONSTRUCTED_MARKER = Symbol(\"already-constructed-marker\");\r\n\r\n// https://html.spec.whatwg.org/multipage/dom.html#htmlconstructor\r\nfunction HTMLConstructor(globalObject, constructorName, newTarget) {\r\n  const registry = implForWrapper(globalObject.customElements);\r\n  if (newTarget === HTMLConstructor) {\r\n    throw new TypeError(\"Invalid constructor\");\r\n  }\r\n\r\n  const definition = registry._customElementDefinitions.find(entry => entry.objectReference === newTarget);\r\n  if (definition === undefined) {\r\n    throw new TypeError(\"Invalid constructor, the constructor is not part of the custom element registry\");\r\n  }\r\n\r\n  let isValue = null;\r\n\r\n  if (definition.localName === definition.name) {\r\n    if (constructorName !== \"HTMLElement\") {\r\n      throw new TypeError(\"Invalid constructor, autonomous custom element should extend from HTMLElement\");\r\n    }\r\n  } else {\r\n    const validLocalNames = getValidTagNames(HTML_NS, constructorName);\r\n    if (!validLocalNames.includes(definition.localName)) {\r\n      throw new TypeError(`${definition.localName} is not valid local name for ${constructorName}`);\r\n    }\r\n\r\n    isValue = definition.name;\r\n  }\r\n\r\n  let { prototype } = newTarget;\r\n\r\n  if (prototype === null || typeof prototype !== \"object\") {\r\n    // The following line deviates from the specification. The HTMLElement prototype should be retrieved from the realm\r\n    // associated with the \"new.target\". Because it is impossible to get such information in jsdom, we fallback to the\r\n    // HTMLElement prototype associated with the current object.\r\n    prototype = globalObject.HTMLElement.prototype;\r\n  }\r\n\r\n  if (definition.constructionStack.length === 0) {\r\n    const documentImpl = implForWrapper(globalObject.document);\r\n\r\n    const elementImpl = createElement(documentImpl, definition.localName, HTML_NS);\r\n\r\n    const element = wrapperForImpl(elementImpl);\r\n    Object.setPrototypeOf(element, prototype);\r\n\r\n    elementImpl._ceState = \"custom\";\r\n    elementImpl._ceDefinition = definition;\r\n    elementImpl._isValue = isValue;\r\n\r\n    return element;\r\n  }\r\n\r\n  const elementImpl = definition.constructionStack[definition.constructionStack.length - 1];\r\n  const element = wrapperForImpl(elementImpl);\r\n\r\n  if (elementImpl === ALREADY_CONSTRUCTED_MARKER) {\r\n    throw new TypeError(\"This instance is already constructed\");\r\n  }\r\n\r\n  Object.setPrototypeOf(element, prototype);\r\n\r\n  definition.constructionStack[definition.constructionStack.length - 1] = ALREADY_CONSTRUCTED_MARKER;\r\n\r\n  return element;\r\n}\r\n\r\nmodule.exports = {\r\n  HTMLConstructor\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}